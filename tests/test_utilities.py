from rocketpy import utilities
import numpy as np


def test_compute_CdS_from_drop_test():
    assert (
        utilities.compute_CdS_from_drop_test(31.064, 18, 1.0476) == 0.3492311157844522
    )


def test_create__dispersion_dictionary():
    """Test if the function returns a dictionary with the correct keys.
    It reads the keys from the dictionary generated by the utilities function
    and compares them to the expected.
    Be careful if you change the "fixtures/dispersion/Valetudo_inputs.csv" file.
    """

    returned_dict = utilities.create_dispersion_dictionary(
        "fixtures/dispersion/Valetudo_inputs.csv"
    )

    test_dict = np.genfromtxt(
        "fixtures/dispersion/Valetudo_inputs.csv",
        usecols=(1, 2, 3),
        skip_header=1,
        delimiter=";",
        dtype=str,
    )

    assert returned_dict == test_dict
